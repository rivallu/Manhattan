

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>modules.Decompression &mdash; documentation Manhattan Python 3.6.1</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Recherche" href="../../search.html"/>
    <link rel="top" title="documentation Manhattan Python 3.6.1" href="../../index.html"/>
        <link rel="up" title="Code du module" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Manhattan
          

          
          </a>

          
            
            
              <div class="version">
                Python 3.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Manhattan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Code du module</a> &raquo;</li>
        
      <li>modules.Decompression</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Code source de modules.Decompression</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1">#-*-coding:UTF-8-*-</span>


<div class="viewcode-block" id="CinDico"><a class="viewcode-back" href="../../modules.html#modules.Decompression.CinDico">[docs]</a><span class="k">def</span> <span class="nf">CinDico</span><span class="p">(</span><span class="n">caractere</span><span class="p">,</span> <span class="n">dictionnaire</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fonction permettant de détecter la présence d&#39;un code dans le dictionnaire construit par Decompress.</span>
<span class="sd">    </span>
<span class="sd">    :param caractere: Paramètre correspondant au code d&#39;un caractère ou d&#39;une suite de caractères compressé.</span>
<span class="sd">    :param dictionnaire: Liste correspondant au dictionnaire en cours d&#39;utilisation et construit par Decompress()</span>
<span class="sd">    </span>
<span class="sd">    :return test: Variable de type Integer ayant pour valeur -1 si le code ne se trouve pas dans le dictionnaire entrée en paramètre ou la position du code dans le dictionnaire en cas de détection. Cela permet à Decompress de récupérer la suite de caractères correspondante.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">test</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionnaire</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">caractere</span> <span class="o">==</span> <span class="n">dictionnaire</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">test</span></div>

<div class="viewcode-block" id="startDecompress"><a class="viewcode-back" href="../../modules.html#modules.Decompression.startDecompress">[docs]</a><span class="k">def</span> <span class="nf">startDecompress</span><span class="p">(</span><span class="n">fileName</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fonction générique permettant de décompresser suivant l&#39;algorithme de compression utilisé.</span>
<span class="sd">    </span>
<span class="sd">    :param fileName: Chemin d&#39;accès de l&#39;archive dont on souhaite la décompression.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">LectureFichier</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="n">fileOut</span><span class="o">=</span><span class="n">fileName</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
    <span class="n">Decompress</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span><span class="n">fileOut</span><span class="p">)</span></div>

<div class="viewcode-block" id="LectureFichier"><a class="viewcode-back" href="../../modules.html#modules.Decompression.LectureFichier">[docs]</a><span class="k">def</span> <span class="nf">LectureFichier</span><span class="p">(</span><span class="n">chemin</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fonction permettant de lire l&#39;archive et de produire une liste formatée pour la décompression par la fonction Decompress().</span>
<span class="sd">    </span>
<span class="sd">    LectureFichier produit d&#39;abord une liste contenant chaque ligne de l&#39;archive compressée.</span>
<span class="sd">    </span>
<span class="sd">    La compression ayant ajouté 2 &quot;\n&quot; dans l&#39;archive, LectureFichier cherche donc un élément de la liste correspondant à &quot;b&#39;\n&#39;&quot; afin de collecter tout ce qui se toruve avant comme étant du texte à décoder et tout ce qui se trouve après comme étant le bit de poids fort manquant à chaque caractère.</span>
<span class="sd">    </span>
<span class="sd">    Par la suite, LectureFichier lit chaque bit de poids fort et l&#39;ajoute au code du caractère auquel il devrait appartenir.</span>
<span class="sd">    </span>
<span class="sd">    Enfin, chaque code est casté en string puis le &quot;0b&quot; restant suite au cast est retiré afin de ne garder qu&#39;une suite de bit.</span>
<span class="sd">    </span>
<span class="sd">    Enfin, la fonction retourne la liste correctement formatée et exploitable par Decompress()</span>
<span class="sd">    </span>
<span class="sd">    :param chemin: Paramètre contenant le chemin d&#39;accès de l&#39;archive à décompresser.</span>
<span class="sd">    </span>
<span class="sd">    :raise IndexError: Afin de coder les 9ème bits en hexadecimal, il a fallu ajouter des 0 non significatifs à la fin de la liste des 9ème bits. En effet, nous devions posséder une liste de 9ème bits divisible par 8 pour coder en hexadécimal d&#39;où l&#39;ajout de zéro. Cela entraîne ici une erreur IndexError étant donné qu&#39;il n&#39;existe pas de code en hexadécimal pour les 9ème bits ajoutés artificiellement. On sort alors de la boucle for en provoquant un break une fois cette erreur rencontrée (qui correspondra donc au premier 9ème bits non significatifs).</span>
<span class="sd">    </span>
<span class="sd">    :return ligne: Liste formatée des codes de caractères sur 9 bits prête à être interprêtée par Decompress()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">fichier</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">chemin</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>

    <span class="n">ligne</span> <span class="o">=</span> <span class="n">fichier</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ligne</span><span class="p">)</span>
    <span class="n">ninebit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">sauv</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ligne</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="p">:</span>
            <span class="n">sauv</span> <span class="o">=</span> <span class="n">i</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sauv</span><span class="p">):</span>
        <span class="n">ligne</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ligne</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ligne</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sauv</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">ligne</span><span class="p">[</span><span class="n">sauv</span><span class="p">]</span> <span class="o">=</span> <span class="n">ligne</span><span class="p">[</span><span class="n">sauv</span><span class="p">]</span> <span class="o">+</span> <span class="n">ligne</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">ligne</span> <span class="o">=</span> <span class="p">[</span><span class="n">ligne</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ligne</span><span class="p">[</span><span class="n">sauv</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ligne</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">bit9</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="n">ligne</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bit9</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>

        <span class="n">zero</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="o">-</span><span class="n">n</span><span class="p">):</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="n">zero</span> <span class="o">+</span> <span class="s2">&quot;0&quot;</span>
        <span class="n">bit9</span> <span class="o">=</span> <span class="n">zero</span> <span class="o">+</span> <span class="n">bit9</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

        <span class="n">ninebit</span> <span class="o">=</span> <span class="n">ninebit</span> <span class="o">+</span> <span class="n">bit9</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bit9</span><span class="p">))</span> <span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="n">carac</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="n">ligne</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">IndexError</span> <span class="p">:</span>
                <span class="k">break</span>

            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">carac</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">zero</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="o">-</span><span class="n">n</span><span class="p">):</span>
                <span class="n">zero</span> <span class="o">=</span> <span class="n">zero</span> <span class="o">+</span> <span class="s2">&quot;0&quot;</span>
            <span class="n">carac</span> <span class="o">=</span> <span class="s2">&quot;0b&quot;</span> <span class="o">+</span> <span class="n">zero</span> <span class="o">+</span> <span class="n">carac</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="n">binary</span> <span class="o">=</span> <span class="n">binary</span> <span class="o">+</span> <span class="s2">&quot;0b&quot;</span> <span class="o">+</span> <span class="n">bit9</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">carac</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

    <span class="n">ligne</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;0b&quot;</span><span class="p">)</span>
    <span class="n">ligne</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">fichier</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ligne</span></div>


<div class="viewcode-block" id="Decompress"><a class="viewcode-back" href="../../modules.html#modules.Decompression.Decompress">[docs]</a><span class="k">def</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">caracteres</span><span class="p">,</span><span class="n">fileOut</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decompress est la fonction servant à décoder un texte compressé en suivant la méthode de l&#39;algorithme LZW.</span>
<span class="sd">    </span>
<span class="sd">    Elle s&#39;appuie sur la fonction LectureFichier afin de recevoir une liste correctement formatée pour la décompression.</span>
<span class="sd">    </span>
<span class="sd">    :param caracteres: Il s&#39;agit d&#39;une liste dont chaque élément correspond au code ASCII ou du dictionnaire d&#39;un caractère ou d&#39;une suite de caractère compressé. Ce code doit être exprimé en bit, type string sans le 0b ajouté par le type bytes. LectureFichier() peut fournir une telle liste formatée à partir d&#39;un fichier texte.</span>
<span class="sd">    :param fileOut: Paramètre contenant le chemin d&#39;accès souhaité par l&#39;utilisateur pour écriture du fichier décompressé.</span>
<span class="sd">    </span>
<span class="sd">    :raise IndexError: Lors du premier ajout au dictionnaire, la liste est vide. Or, dans le try, nous essayons de récupérer le dernier indice du code ajouté au dictionnaire. Cela générère une erreur IndexError qui est gérée dans le except. En effet, dans ce cas, nous ajoutons au dictionnaire le code avec pour indice 256 ce qui permet de l&#39;initialiser et de ne plus rencontrer l&#39;erreur par la suite.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">resultat</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileOut</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">dictionnaire</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">resultat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">caracteres</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">w</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">caracteres</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">caracteres</span><span class="p">)):</span>
        <span class="n">presence</span> <span class="o">=</span> <span class="n">CinDico</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">caracteres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dictionnaire</span><span class="p">)</span>
        <span class="n">test_code</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">caracteres</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">test_code</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">and</span>  <span class="n">presence</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
            <span class="n">entree</span> <span class="o">=</span> <span class="n">dictionnaire</span><span class="p">[</span><span class="n">presence</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">test_code</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="ow">and</span> <span class="n">presence</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">:</span>
            <span class="n">entree</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span> <span class="p">:</span>
            <span class="n">entree</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">test_code</span><span class="p">)</span>

        <span class="n">resultat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">entree</span><span class="p">)</span>

        <span class="k">try</span> <span class="p">:</span>
            <span class="n">dictionnaire</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dictionnaire</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="n">entree</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="p">:</span>
            <span class="n">dictionnaire</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">256</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="n">entree</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionnaire</span><span class="p">)</span> <span class="o">==</span> <span class="mi">256</span> <span class="p">:</span>
            <span class="n">dictionnaire</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">entree</span>

    <span class="n">resultat</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="s2">&quot;Opération Réussie !&quot;</span></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Lucas Rival &amp; Alexandre Matthey-Doret.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'Python 3.6.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>